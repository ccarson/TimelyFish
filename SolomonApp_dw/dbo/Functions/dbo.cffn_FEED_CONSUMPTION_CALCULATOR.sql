

-- =============================================
-- Author:		Matt Brandt
-- Create date: 12/23/2010
-- Description:	This function projects the amount of feed a pig has eaten given a starting pig weight 
-- and number of days of feed consumption.
-- =============================================
CREATE FUNCTION [dbo].[cffn_FEED_CONSUMPTION_CALCULATOR] 
(@StartWeight Float, @GrowthDays Int)
RETURNS Float
AS
BEGIN
	-- Declare the return variable here
	DECLARE @FeedConsumed Float

Declare @BaseDay Table
(BaseDay Int, BaseWeight Float, TotalFeedConsumed Float)

insert into @BaseDay values (1,10,0)
insert into @BaseDay values (2,14.124,0.5165)
insert into @BaseDay values (3,14.848,1.033)
insert into @BaseDay values (4,15.572,1.5495)
insert into @BaseDay values (5,16.296,2.066)
insert into @BaseDay values (6,17.02,2.5825)
insert into @BaseDay values (7,17.744,3.099)
insert into @BaseDay values (8,18.468,3.6155)
insert into @BaseDay values (9,19.318,4.49733)
insert into @BaseDay values (10,20.168,5.37916)
insert into @BaseDay values (11,21.018,6.26099)
insert into @BaseDay values (12,21.868,7.14282)
insert into @BaseDay values (13,22.718,8.02465)
insert into @BaseDay values (14,23.568,8.90648)
insert into @BaseDay values (15,24.418,9.78831)
insert into @BaseDay values (16,25.331,11.06697)
insert into @BaseDay values (17,26.244,12.34563)
insert into @BaseDay values (18,27.157,13.62429)
insert into @BaseDay values (19,28.07,14.90295)
insert into @BaseDay values (20,28.983,16.18161)
insert into @BaseDay values (21,29.896,17.46027)
insert into @BaseDay values (22,30.809,18.73893)
insert into @BaseDay values (23,31.848,20.39237)
insert into @BaseDay values (24,32.887,22.04581)
insert into @BaseDay values (25,33.926,23.69925)
insert into @BaseDay values (26,34.965,25.35269)
insert into @BaseDay values (27,36.004,27.00613)
insert into @BaseDay values (28,37.043,28.65957)
insert into @BaseDay values (29,38.082,30.31301)
insert into @BaseDay values (30,39.279,32.42311)
insert into @BaseDay values (31,40.476,34.53321)
insert into @BaseDay values (32,41.673,36.64331)
insert into @BaseDay values (33,42.87,38.75341)
insert into @BaseDay values (34,44.067,40.86351)
insert into @BaseDay values (35,45.264,42.97361)
insert into @BaseDay values (36,46.461,45.08371)
insert into @BaseDay values (37,47.815,47.50875)
insert into @BaseDay values (38,49.169,49.93379)
insert into @BaseDay values (39,50.523,52.35883)
insert into @BaseDay values (40,51.877,54.78387)
insert into @BaseDay values (41,53.231,57.20891)
insert into @BaseDay values (42,54.585,59.63395)
insert into @BaseDay values (43,55.939,62.05899)
insert into @BaseDay values (44,57.419,64.81472)
insert into @BaseDay values (45,58.899,67.57045)
insert into @BaseDay values (46,60.379,70.32618)
insert into @BaseDay values (47,61.859,73.08191)
insert into @BaseDay values (48,63.339,75.83764)
insert into @BaseDay values (49,64.819,78.59337)
insert into @BaseDay values (50,66.299,81.3491)
insert into @BaseDay values (51,67.937,84.43552)
insert into @BaseDay values (52,69.575,87.52194)
insert into @BaseDay values (53,71.213,90.60836)
insert into @BaseDay values (54,72.851,93.69478)
insert into @BaseDay values (55,74.489,96.7812)
insert into @BaseDay values (56,76.127,99.86762)
insert into @BaseDay values (57,77.765,102.95404)
insert into @BaseDay values (58,79.56,106.38689)
insert into @BaseDay values (59,81.355,109.81974)
insert into @BaseDay values (60,83.15,113.25259)
insert into @BaseDay values (61,84.945,116.68544)
insert into @BaseDay values (62,86.74,120.11829)
insert into @BaseDay values (63,88.535,123.55114)
insert into @BaseDay values (64,90.33,126.98399)
insert into @BaseDay values (65,92.188,130.73179)
insert into @BaseDay values (66,94.046,134.47959)
insert into @BaseDay values (67,95.904,138.22739)
insert into @BaseDay values (68,97.762,141.97519)
insert into @BaseDay values (69,99.62,145.72299)
insert into @BaseDay values (70,101.478,149.47079)
insert into @BaseDay values (71,103.336,153.21859)
insert into @BaseDay values (72,105.32,157.37581)
insert into @BaseDay values (73,107.304,161.53303)
insert into @BaseDay values (74,109.288,165.69025)
insert into @BaseDay values (75,111.272,169.84747)
insert into @BaseDay values (76,113.256,174.00469)
insert into @BaseDay values (77,115.24,178.16191)
insert into @BaseDay values (78,117.224,182.31913)
insert into @BaseDay values (79,119.271,186.88577)
insert into @BaseDay values (80,121.318,191.45241)
insert into @BaseDay values (81,123.365,196.01905)
insert into @BaseDay values (82,125.412,200.58569)
insert into @BaseDay values (83,127.459,205.15233)
insert into @BaseDay values (84,129.506,209.71897)
insert into @BaseDay values (85,131.553,214.28561)
insert into @BaseDay values (86,133.695,219.32466)
insert into @BaseDay values (87,135.837,224.36371)
insert into @BaseDay values (88,137.979,229.40276)
insert into @BaseDay values (89,140.121,234.44181)
insert into @BaseDay values (90,142.263,239.48086)
insert into @BaseDay values (91,144.405,244.51991)
insert into @BaseDay values (92,146.547,249.55896)
insert into @BaseDay values (93,148.783,255.07042)
insert into @BaseDay values (94,151.019,260.58188)
insert into @BaseDay values (95,153.255,266.09334)
insert into @BaseDay values (96,155.491,271.6048)
insert into @BaseDay values (97,157.727,277.11626)
insert into @BaseDay values (98,159.963,282.62772)
insert into @BaseDay values (99,162.199,288.13918)
insert into @BaseDay values (100,164.498,293.8711)
insert into @BaseDay values (101,166.797,299.60302)
insert into @BaseDay values (102,169.096,305.33494)
insert into @BaseDay values (103,171.395,311.06686)
insert into @BaseDay values (104,173.694,316.79878)
insert into @BaseDay values (105,175.993,322.5307)
insert into @BaseDay values (106,178.292,328.26262)
insert into @BaseDay values (107,180.591,333.99454)
insert into @BaseDay values (108,182.89,339.72646)
insert into @BaseDay values (109,185.189,345.45838)
insert into @BaseDay values (110,187.488,351.1903)
insert into @BaseDay values (111,189.787,356.92222)
insert into @BaseDay values (112,192.086,362.65414)
insert into @BaseDay values (113,194.385,368.38606)
insert into @BaseDay values (114,196.621,373.89752)
insert into @BaseDay values (115,198.857,379.40898)
insert into @BaseDay values (116,201.093,384.92044)
insert into @BaseDay values (117,203.329,390.4319)
insert into @BaseDay values (118,205.565,395.94336)
insert into @BaseDay values (119,207.801,401.45482)
insert into @BaseDay values (120,210.037,406.96628)
insert into @BaseDay values (121,212.305,413.58004)
insert into @BaseDay values (122,214.573,420.1938)
insert into @BaseDay values (123,216.841,426.80756)
insert into @BaseDay values (124,219.109,433.42132)
insert into @BaseDay values (125,221.377,440.03508)
insert into @BaseDay values (126,223.645,446.64884)
insert into @BaseDay values (127,225.913,453.2626)
insert into @BaseDay values (128,228.118,460.09682)
insert into @BaseDay values (129,230.323,466.93104)
insert into @BaseDay values (130,232.528,473.76526)
insert into @BaseDay values (131,234.733,480.59948)
insert into @BaseDay values (132,236.938,487.4337)
insert into @BaseDay values (133,239.143,494.26792)
insert into @BaseDay values (134,241.348,501.10214)
insert into @BaseDay values (135,243.553,507.93636)
insert into @BaseDay values (136,245.758,514.77058)
insert into @BaseDay values (137,247.963,521.6048)
insert into @BaseDay values (138,250.168,528.43902)
insert into @BaseDay values (139,252.373,535.27324)
insert into @BaseDay values (140,254.578,542.10746)
insert into @BaseDay values (141,256.783,548.94168)
insert into @BaseDay values (142,258.988,555.7759)
insert into @BaseDay values (143,261.193,562.61012)
insert into @BaseDay values (144,263.398,569.44434)
insert into @BaseDay values (145,265.603,576.27856)
insert into @BaseDay values (146,267.808,583.11278)
insert into @BaseDay values (147,270.013,589.947)
insert into @BaseDay values (148,272.218,596.78122)
insert into @BaseDay values (149,274.202,600.93844)
insert into @BaseDay values (150,276.186,605.09566)
insert into @BaseDay values (151,278.17,609.25288)
insert into @BaseDay values (152,280.154,613.4101)
insert into @BaseDay values (153,282.138,617.56732)
insert into @BaseDay values (154,284.122,621.72454)
insert into @BaseDay values (155,286.106,625.88176)
insert into @BaseDay values (156,288.09,630.03898)
insert into @BaseDay values (157,290.074,634.1962)
insert into @BaseDay values (158,292.058,638.35342)
insert into @BaseDay values (159,294.042,642.51064)
insert into @BaseDay values (160,296.026,646.66786)
insert into @BaseDay values (161,298.01,650.82508)
insert into @BaseDay values (162,299.994,654.9823)
insert into @BaseDay values (163,301.758,662.85582)
insert into @BaseDay values (164,303.522,670.72934)
insert into @BaseDay values (165,305.286,678.60286)
insert into @BaseDay values (166,307.05,686.47638)
insert into @BaseDay values (167,308.814,694.3499)
insert into @BaseDay values (168,310.578,702.22342)
insert into @BaseDay values (169,312.342,710.09694)
insert into @BaseDay values (170,314.106,717.97046)
insert into @BaseDay values (171,315.87,725.84398)
insert into @BaseDay values (172,317.634,733.7175)
insert into @BaseDay values (173,319.398,741.59102)
insert into @BaseDay values (174,321.162,749.46454)
insert into @BaseDay values (175,322.926,757.33806)
insert into @BaseDay values (176,324.69,765.21158)
insert into @BaseDay values (177,326.454,773.0851)
insert into @BaseDay values (178,328.218,780.95862)
insert into @BaseDay values (179,329.982,788.83214)
insert into @BaseDay values (180,331.746,796.70566)
insert into @BaseDay values (181,333.51,804.57918)
insert into @BaseDay values (182,335.274,812.4527)
insert into @BaseDay values (183,337.038,820.32622)
insert into @BaseDay values (184,338.802,828.19974)
insert into @BaseDay values (185,340.566,836.07326)
insert into @BaseDay values (186,342.33,843.94678)
insert into @BaseDay values (187,344.094,851.8203)
insert into @BaseDay values (188,345.858,859.69382)
insert into @BaseDay values (189,347.622,867.56734)
insert into @BaseDay values (190,349.386,875.44086)
insert into @BaseDay values (191,351.15,883.31438)
insert into @BaseDay values (192,352.914,891.1879)
insert into @BaseDay values (193,354.678,899.06142)
insert into @BaseDay values (194,356.442,906.93494)
insert into @BaseDay values (195,358.206,914.80846)
insert into @BaseDay values (196,359.97,922.68198)
insert into @BaseDay values (197,361.734,930.5555)
insert into @BaseDay values (198,363.498,938.42902)
insert into @BaseDay values (199,365.262,946.30254)
insert into @BaseDay values (200,367.026,954.17606)
insert into @BaseDay values (201,368.79,962.04958)
insert into @BaseDay values (202,370.554,969.9231)
insert into @BaseDay values (203,372.318,977.79662)
insert into @BaseDay values (204,374.082,985.67014)
insert into @BaseDay values (205,375.846,993.54366)
insert into @BaseDay values (206,377.61,1001.41718)
insert into @BaseDay values (207,379.374,1009.2907)
insert into @BaseDay values (208,381.138,1017.16422)
insert into @BaseDay values (209,382.902,1025.03774)
insert into @BaseDay values (210,384.666,1032.91126)
insert into @BaseDay values (211,386.43,1040.78478)
insert into @BaseDay values (212,388.194,1048.6583)
insert into @BaseDay values (213,389.958,1056.53182)
insert into @BaseDay values (214,391.722,1064.40534)
insert into @BaseDay values (215,393.486,1072.27886)
insert into @BaseDay values (216,395.25,1080.15238)
insert into @BaseDay values (217,397.014,1088.0259)
insert into @BaseDay values (218,398.778,1095.89942)


Declare @TargetDay Int
Declare @BaseWeight Float

Set @TargetDay = (Select Top 1 BaseDay From @BaseDay Where BaseWeight >= @StartWeight Order By BaseDay)
Set @BaseWeight = (Select BaseWeight From @BaseDay Where BaseDay = @TargetDay)

	Select @FeedConsumed = 
		Case When @StartWeight > 400 Then Null
			When @GrowthDays = 0 Then 0
		Else (Select TotalFeedConsumed From @BaseDay Where BaseDay = (@TargetDay+@GrowthDays))
			-
			 (Select TotalFeedConsumed From @BaseDay Where BaseDay = @TargetDay)
		End
			
Return @FeedConsumed

End

