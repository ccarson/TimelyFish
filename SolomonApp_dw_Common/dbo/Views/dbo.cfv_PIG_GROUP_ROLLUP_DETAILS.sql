CREATE VIEW [dbo].[cfv_PIG_GROUP_ROLLUP_DETAILS]
AS

SELECT
	TaskID,
	MasterGroup,
	SiteContactID,
	PigFlowID,
	ReportingGroupID,
	ActCloseDate,
	ActStartDate,
	MasterActCloseDate,
	MasterActStartDate,
	BarnNbr,
	Description,
	PodDescription,
	PGStatusID,
	PigGenderTypeID,
	Phase,
	MasterSvcManager SvcManager,
	MasterSrSvcManager SrSvcManager,
	LivePigDays,
	DeadPigDays,
	TotalPigDays,
	Feed_Qty,
	TransferIn_Qty,
	MoveIn_Qty,
	MoveOut_Qty,
	PigDeath_Qty,
	TransferOut_Qty,
	TransferToTailender_Qty,
	Prim_Qty,
	Cull_Qty,
	DeadPigsToPacker_Qty,
	TransportDeath_Qty,
	InventoryAdjustment_Qty,
	Top_Qty,
	TransferIn_Wt,
	MoveIn_Wt,
	MoveOut_Wt,
	TransferOut_Wt,
	TransferToTailender_Wt,
	Prim_Wt,
	Cull_Wt,
	DeadPigsToPacker_Wt,
	TransportDeath_Wt,
	Top_Wt,
	MedicationCost,
	WeightGained,
	HeadStarted,
	TotalHeadProduced,
	AverageDailyGain,
	AdjAverageDailyGain,
	FeedToGain,
	AdjFeedToGain,
	Mortality,
	AveragePurchase_Wt,
	AverageOut_Wt,
	AverageDailyFeedIntake,
	Tailender_Pct,
	DeadPigsToPacker_Pct,
	Cull_Pct,
	NoValue_Pct,
	MedicationCostPerHead,
	VaccinationCost,
	FeedCost,
	HeadCapacity,
	PigStartDate,
	PigEndDate,
	HeadSold,
	AverageMarket_Wt,
	DaysInGroup,
	PigCapacityDays,
	EmptyDays,
	EmptyCapacityDays,
	CapacityDays,
	TotalCapacityDays,
	AverageDaysInGroup,
	AverageEmptyDays,
	Utilization,
	MedicationCostPerHeadSold,
	VaccinationCostPerHeadSold,
	FeedCostPerHundredGain,
	DeadOnTruck_qty,
	DeadInYard_qty,
	CondemnedByPacker_qty,
	Condemned_qty,
	DeadOnTruck_Wt,
	DeadInYard_wt,
	CondemnedByPacker_wt,
	Condemned_wt
FROM	dbo.cft_PIG_GROUP_ROLLUP

UNION ALL
SELECT
	'MG' + MasterGroup AS TaskID,
	MasterGroup,
	SiteContactID,
	PigFlowID,
	ReportingGroupID,
	ActCloseDate,
	ActStartDate,
	ActCloseDate MasterActCloseDate,
	ActStartDate MasterActStartDate,
	BarnNbr,
	Description,
	PodDescription,
	NULL,
	NULL,
	Phase,
	SvcManager,
	SrSvcManager,
	LivePigDays,
	DeadPigDays,
	TotalPigDays,
	Feed_Qty,
	TransferIn_Qty,
	MoveIn_Qty,
	MoveOut_Qty,
	PigDeath_Qty,
	TransferOut_Qty,
	TransferToTailender_Qty,
	Prim_Qty,
	Cull_Qty,
	DeadPigsToPacker_Qty,
	TransportDeath_Qty,
	InventoryAdjustment_Qty,
	Top_Qty,
	TransferIn_Wt,
	MoveIn_Wt,
	MoveOut_Wt,
	TransferOut_Wt,
	TransferToTailender_Wt,
	Prim_Wt,
	Cull_Wt,
	DeadPigsToPacker_Wt,
	TransportDeath_Wt,
	Top_Wt,
	MedicationCost,
	WeightGained,
	HeadStarted,
	TotalHeadProduced,
	AverageDailyGain,
	AdjAverageDailyGain,
	FeedToGain,
	AdjFeedToGain,
	Mortality,
	AveragePurchase_Wt,
	AverageOut_Wt,
	AverageDailyFeedIntake,
	Tailender_Pct,
	DeadPigsToPacker_Pct,
	Cull_Pct,
	NoValue_Pct,
	MedicationCostPerHead,
	VaccinationCost,
	FeedCost,
	HeadCapacity,
	PigStartDate,
	PigEndDate,
	HeadSold,
	AverageMarket_Wt,
	DaysInGroup,
	PigCapacityDays,
	EmptyDays,
	EmptyCapacityDays,
	CapacityDays,
	TotalCapacityDays,
	AverageDaysInGroup,
	AverageEmptyDays,
	Utilization,
	MedicationCostPerHeadSold,
	VaccinationCostPerHeadSold,
	FeedCostPerHundredGain,
	DeadOnTruck_qty,
	DeadInYard_qty,
	CondemnedByPacker_qty,
	Condemned_qty,
	DeadOnTruck_Wt,
	DeadInYard_wt,
	CondemnedByPacker_wt,
	Condemned_wt
FROM	dbo.cft_PIG_MASTER_GROUP_ROLLUP ;
